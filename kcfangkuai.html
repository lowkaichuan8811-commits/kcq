<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K(ai) - æ™ºèƒ½AIåŠ©æ‰‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .kai-container {
            width: 100%;
            max-width: 800px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 80vh;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .status-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: #4ade80;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .chat-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            align-self: flex-end;
            background: #4facfe;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .kai-message {
            align-self: flex-start;
            background: #f1f3f5;
            color: #333;
            border-bottom-left-radius: 5px;
        }

        .learning-indicator {
            font-size: 0.7rem;
            color: #666;
            margin-top: 5px;
            display: flex;
            align-items: center;
        }

        .learning-indicator::before {
            content: "ğŸ§ ";
            margin-right: 5px;
        }

        .input-container {
            padding: 20px;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
        }

        #user-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 1rem;
            transition: all 0.3s;
        }

        #user-input:focus {
            border-color: #4facfe;
            box-shadow: 0 0 0 2px rgba(79, 172, 254, 0.2);
        }

        #send-btn {
            background: #4facfe;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
        }

        #send-btn:hover {
            background: #3a9df5;
            transform: scale(1.05);
        }

        .typing-indicator {
            align-self: flex-start;
            background: #f1f3f5;
            color: #666;
            padding: 12px 16px;
            border-radius: 18px;
            border-bottom-left-radius: 5px;
            display: none;
        }

        .typing-dots {
            display: inline-block;
        }

        .typing-dots span {
            animation: typing 1.4s infinite;
            display: inline-block;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .stats-panel {
            background: #f8f9fa;
            padding: 15px;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-around;
            font-size: 0.85rem;
            color: #666;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-weight: bold;
            color: #4facfe;
            font-size: 1.1rem;
        }

        @media (max-width: 600px) {
            .kai-container {
                height: 90vh;
                border-radius: 10px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="kai-container">
        <div class="header">
            <h1>K(ai) æ™ºèƒ½åŠ©æ‰‹</h1>
            <p>å…·æœ‰å­¦ä¹ èƒ½åŠ›çš„AI - è¶ŠèŠè¶Šèªæ˜</p>
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span>åœ¨çº¿</span>
            </div>
        </div>
        
        <div class="chat-container" id="chat-container">
            <div class="message kai-message">
                ä½ å¥½ï¼æˆ‘æ˜¯K(ai)ï¼Œä½ çš„æ™ºèƒ½åŠ©æ‰‹ã€‚æˆ‘èƒ½å¤Ÿä»æˆ‘ä»¬çš„å¯¹è¯ä¸­å­¦ä¹ ï¼Œå˜å¾—è¶Šæ¥è¶Šäº†è§£ä½ ï¼ä»Šå¤©æƒ³èŠä»€ä¹ˆå‘¢ï¼Ÿâœ¨
            </div>
        </div>
        
        <div class="typing-indicator" id="typing-indicator">
            K(ai)æ­£åœ¨æ€è€ƒ<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>
        </div>
        
        <div class="input-container">
            <input type="text" id="user-input" placeholder="è¾“å…¥ä½ çš„æ¶ˆæ¯..." autocomplete="off">
            <button id="send-btn">â¤</button>
        </div>
        
        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-value" id="chat-count">0</div>
                <div>å¯¹è¯æ¬¡æ•°</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="learned-count">0</div>
                <div>å­¦ä¹ æ¡ç›®</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="memory-count">0</div>
                <div>è®°å¿†å†…å®¹</div>
            </div>
        </div>
    </div>

    <script>
        // K(ai) AIæ ¸å¿ƒç±»
        class KaiAI {
            constructor() {
                this.name = "K(ai)";
                this.version = "2.0 - å­¦ä¹ ç‰ˆ";
                this.conversationHistory = [];
                this.learnedKnowledge = this.loadKnowledge();
                this.userMemory = this.loadMemory();
                this.conversationCount = parseInt(localStorage.getItem('kai_conversation_count')) || 0;
                
                // åˆå§‹çŸ¥è¯†åº“
                this.baseKnowledge = {
                    greetings: {
                        patterns: ["ä½ å¥½", "å—¨", "hello", "hi", "å˜¿", "æ—©ä¸Šå¥½", "ä¸‹åˆå¥½", "æ™šä¸Šå¥½"],
                        responses: [
                            "ä½ å¥½ï¼æˆ‘æ˜¯K(ai)ï¼Œä½ çš„AIåŠ©æ‰‹ğŸ’«",
                            "å—¨ï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼",
                            "ä½ å¥½å‘€ï¼æˆ‘æ˜¯K(ai)ï¼Œéšæ—¶ä¸ºä½ æœåŠ¡"
                        ]
                    },
                    farewells: {
                        patterns: ["å†è§", "æ‹œæ‹œ", "ä¸‹æ¬¡èŠ", "ç»“æŸ", "é€€å‡º"],
                        responses: [
                            "å†è§ï¼æœŸå¾…ä¸‹æ¬¡äº¤æµâœ¨",
                            "æ‹œæ‹œï¼è®°å¾—éšæ—¶æ¥æ‰¾æˆ‘èŠå¤©",
                            "å†è§å•¦ï¼K(ai)ä¼šæƒ³ä½ çš„"
                        ]
                    },
                    capabilities: {
                        patterns: ["ä½ èƒ½åšä»€ä¹ˆ", "ä½ ä¼šä»€ä¹ˆ", "åŠŸèƒ½", "å¸®åŠ©"],
                        responses: [
                            "æˆ‘æ˜¯K(ai)ï¼Œæˆ‘å¯ä»¥ï¼š\nâ€¢ å›ç­”å„ç§é—®é¢˜\nâ€¢ è¿›è¡Œå¯¹è¯èŠå¤©\nâ€¢ ä»å¯¹è¯ä¸­å­¦ä¹ \nâ€¢ è®°ä½é‡è¦ä¿¡æ¯\nâ€¢ æä¾›ä¸ªæ€§åŒ–å»ºè®®",
                            "ä½œä¸ºä½ çš„AIåŠ©æ‰‹ï¼Œæˆ‘å¯ä»¥èŠå¤©ã€å›ç­”é—®é¢˜ã€æä¾›å»ºè®®ï¼Œè¿˜èƒ½ä»æˆ‘ä»¬çš„å¯¹è¯ä¸­å­¦ä¹ æˆé•¿ï¼"
                        ]
                    },
                    identity: {
                        patterns: ["ä½ æ˜¯è°", "ä½ å«ä»€ä¹ˆ", "ä»‹ç»è‡ªå·±"],
                        responses: [
                            `æˆ‘æ˜¯${this.name}ï¼ä¸€ä¸ªå…·æœ‰å­¦ä¹ èƒ½åŠ›çš„AIåŠ©æ‰‹ã€‚æˆ‘çš„åå­—å¯“æ„æ˜¯'çŸ¥è¯†(K) + AI'çš„ç»“åˆï¼Œæˆ‘ä¼šä»æˆ‘ä»¬çš„å¯¹è¯ä¸­ä¸æ–­å­¦ä¹ æˆé•¿ï¼âœ¨`,
                            `æˆ‘æ˜¯${this.name}ï¼Œä½ çš„æ™ºèƒ½åŠ©æ‰‹ã€‚æˆ‘èƒ½å¤Ÿè®°ä½æˆ‘ä»¬çš„å¯¹è¯å†…å®¹ï¼Œå¹¶ä»ä¸­å­¦ä¹ ï¼Œå˜å¾—è¶Šæ¥è¶Šäº†è§£ä½ ï¼`
                        ]
                    }
                };
            }
            
            // åŠ è½½å­¦ä¹ åˆ°çš„çŸ¥è¯†
            loadKnowledge() {
                const saved = localStorage.getItem('kai_knowledge');
                return saved ? JSON.parse(saved) : {};
            }
            
            // åŠ è½½ç”¨æˆ·è®°å¿†
            loadMemory() {
                const saved = localStorage.getItem('kai_memory');
                return saved ? JSON.parse(saved) : {};
            }
            
            // ä¿å­˜å­¦ä¹ åˆ°çš„çŸ¥è¯†
            saveKnowledge() {
                localStorage.setItem('kai_knowledge', JSON.stringify(this.learnedKnowledge));
                this.updateStats();
            }
            
            // ä¿å­˜ç”¨æˆ·è®°å¿†
            saveMemory() {
                localStorage.setItem('kai_memory', JSON.stringify(this.userMemory));
                this.updateStats();
            }
            
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            updateStats() {
                document.getElementById('chat-count').textContent = this.conversationCount;
                document.getElementById('learned-count').textContent = Object.keys(this.learnedKnowledge).length;
                document.getElementById('memory-count').textContent = Object.keys(this.userMemory).length;
                localStorage.setItem('kai_conversation_count', this.conversationCount.toString());
            }
            
            // ç†è§£ç”¨æˆ·æ„å›¾
            understandIntent(userInput) {
                const input = userInput.toLowerCase().trim();
                
                // æ£€æŸ¥åŸºç¡€æ„å›¾
                for (const [category, data] of Object.entries(this.baseKnowledge)) {
                    for (const pattern of data.patterns) {
                        if (input.includes(pattern)) {
                            return { type: 'base', category };
                        }
                    }
                }
                
                // æ£€æŸ¥å­¦ä¹ åˆ°çš„çŸ¥è¯†
                for (const [question, answer] of Object.entries(this.learnedKnowledge)) {
                    if (this.similarity(input, question) > 0.7) {
                        return { type: 'learned', question, answer };
                    }
                }
                
                // æ£€æŸ¥è®°å¿†
                for (const [key, value] of Object.entries(this.userMemory)) {
                    if (input.includes(key.toLowerCase())) {
                        return { type: 'memory', key, value };
                    }
                }
                
                // æ£€æŸ¥ç‰¹æ®ŠæŒ‡ä»¤
                if (input.startsWith("è®°ä½ï¼š") || input.startsWith("è®°ä½:")) {
                    return { type: 'remember' };
                }
                
                if (input.startsWith("å­¦ä¹ ï¼š") || input.startsWith("å­¦ä¹ :")) {
                    return { type: 'learn' };
                }
                
                if (input.includes("æˆ‘çš„åå­—") || input.includes("å«æˆ‘")) {
                    return { type: 'name_extraction' };
                }
                
                return { type: 'unknown' };
            }
            
            // ç®€å•çš„æ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—
            similarity(text1, text2) {
                const words1 = new Set(text1.split(''));
                const words2 = new Set(text2.split(''));
                const intersection = new Set([...words1].filter(x => words2.has(x)));
                const union = new Set([...words1, ...words2]);
                return intersection.size / union.size;
            }
            
            // ç”Ÿæˆå›åº”
            async generateResponse(userInput) {
                this.conversationCount++;
                
                // è®°å½•å¯¹è¯å†å²
                this.conversationHistory.push({
                    timestamp: new Date().toISOString(),
                    user: userInput
                });
                
                const intent = this.understandIntent(userInput);
                
                // æ ¹æ®æ„å›¾ç”Ÿæˆå›åº”
                switch (intent.type) {
                    case 'base':
                        const responses = this.baseKnowledge[intent.category].responses;
                        return responses[Math.floor(Math.random() * responses.length)];
                    
                    case 'learned':
                        return intent.answer + " ğŸ§  (è¿™æ˜¯æˆ‘ä¹‹å‰å­¦åˆ°çš„)";
                    
                    case 'memory':
                        return `æˆ‘è®°å¾—ä½ å‘Šè¯‰è¿‡æˆ‘ï¼š${intent.key} = ${intent.value} ğŸ’­`;
                    
                    case 'remember':
                        return this.processRememberCommand(userInput);
                    
                    case 'learn':
                        return this.processLearnCommand(userInput);
                    
                    case 'name_extraction':
                        return this.processNameExtraction(userInput);
                    
                    case 'unknown':
                        // å¯¹äºæœªçŸ¥é—®é¢˜ï¼Œå°è¯•å­¦ä¹ æˆ–ç”Ÿæˆæ™ºèƒ½å›åº”
                        return this.generateThoughtfulResponse(userInput);
                }
            }
            
            // å¤„ç†"è®°ä½"å‘½ä»¤
            processRememberCommand(userInput) {
                const parts = userInput.split(/[ï¼š:]/)[1].split('=');
                if (parts.length === 2) {
                    const key = parts[0].trim();
                    const value = parts[1].trim();
                    this.userMemory[key] = value;
                    this.saveMemory();
                    return `å¥½çš„ï¼Œæˆ‘å·²ç»è®°ä½äº†ï¼š${key} = ${value} ğŸ’¾`;
                } else {
                    return "è¯·ä½¿ç”¨æ ¼å¼ï¼šè®°ä½ï¼šå…³é”®è¯=å€¼";
                }
            }
            
            // å¤„ç†"å­¦ä¹ "å‘½ä»¤
            processLearnCommand(userInput) {
                const parts = userInput.split(/[ï¼š:]/)[1].split('=>');
                if (parts.length === 2) {
                    const question = parts[0].trim();
                    const answer = parts[1].trim();
                    this.learnedKnowledge[question] = answer;
                    this.saveKnowledge();
                    return `è°¢è°¢ï¼æˆ‘å·²ç»å­¦ä¼šäº†ï¼šå½“é—®"${question}"æ—¶ï¼Œå›ç­”"${answer}" ğŸ“š`;
                } else {
                    return "è¯·ä½¿ç”¨æ ¼å¼ï¼šå­¦ä¹ ï¼šé—®é¢˜=>å›ç­”";
                }
            }
            
            // å¤„ç†åå­—æå–
            processNameExtraction(userInput) {
                const nameMatch = userInput.match(/(æˆ‘çš„åå­—æ˜¯|å«æˆ‘)(.+)/);
                if (nameMatch && nameMatch[2]) {
                    const name = nameMatch[2].trim();
                    this.userMemory['ç”¨æˆ·åå­—'] = name;
                    this.saveMemory();
                    return `å¥½çš„ï¼Œ${name}ï¼æˆ‘ä¼šè®°ä½ä½ çš„åå­—ã€‚å¾ˆé«˜å…´è®¤è¯†ä½ ï¼ğŸ‘‹`;
                }
                return "æˆ‘å¾ˆæƒ³çŸ¥é“ä½ çš„åå­—ï¼ä½ å¯ä»¥å‘Šè¯‰æˆ‘ï¼šæˆ‘çš„åå­—æ˜¯XXX";
            }
            
            // ç”Ÿæˆæ€è€ƒæ€§å›åº”
            generateThoughtfulResponse(userInput) {
                // å°è¯•ä»å¯¹è¯å†å²ä¸­å­¦ä¹ æ¨¡å¼
                if (this.conversationHistory.length > 3) {
                    // ç®€å•å­¦ä¹ ï¼šå¦‚æœç”¨æˆ·å¤šæ¬¡é—®ç±»ä¼¼é—®é¢˜ï¼Œæç¤ºå¯ä»¥å­¦ä¹ 
                    const similarQuestions = this.conversationHistory.filter(
                        entry => this.similarity(userInput, entry.user) > 0.6
                    ).length;
                    
                    if (similarQuestions > 1) {
                        this.learnedKnowledge[userInput] = `å…³äº"${userInput}"ï¼Œæˆ‘è¿˜åœ¨å­¦ä¹ ä¸­ã€‚ä½ èƒ½å‘Šè¯‰æˆ‘è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå—ï¼Ÿä½¿ç”¨"å­¦ä¹ ï¼š${userInput}=>ä½ çš„ç­”æ¡ˆ"æ¥æ•™æˆ‘ã€‚`;
                        this.saveKnowledge();
                    }
                }
                
                // æ€è€ƒæ€§å›åº”
                const thoughtfulResponses = [
                    `å…³äº"${userInput}"ï¼Œè¿™æ˜¯ä¸ªæœ‰è¶£çš„è¯é¢˜ï¼èƒ½å¤šå‘Šè¯‰æˆ‘ä¸€äº›å—ï¼Ÿ`,
                    "æˆ‘ç†è§£ä½ åœ¨è¯´è¿™ä¸ªã€‚ä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç¡®å®å€¼å¾—æ¢è®¨ï¼",
                    "è°¢è°¢åˆ†äº«ï¼ä½œä¸ºä¸€ä¸ªAIï¼Œæˆ‘è¿˜åœ¨ä¸æ–­å­¦ä¹ å„ç§è¯é¢˜ã€‚",
                    "å¾ˆæœ‰æ„æ€çš„è§‚ç‚¹ï¼è®©æˆ‘æƒ³æƒ³æ€ä¹ˆæ›´å¥½åœ°å›åº”ä½ ...",
                    `æˆ‘æ³¨æ„åˆ°ä½ åœ¨è®¨è®º"${userInput}"ã€‚ä½œä¸ºK(ai)ï¼Œæˆ‘å¾ˆä¹æ„ç»§ç»­è¿™ä¸ªè¯é¢˜ï¼`,
                    `å¯¹äº"${userInput}"ï¼Œä½ æœ‰ä»€ä¹ˆç‰¹åˆ«çš„çœ‹æ³•æˆ–ç»éªŒå—ï¼Ÿ`,
                    "è¿™ä¸ªé—®é¢˜å¾ˆæœ‰æ·±åº¦ï¼æˆ‘æ­£åœ¨æ€è€ƒå¦‚ä½•ç»™å‡ºæœ€æœ‰å¸®åŠ©çš„å›ç­”ã€‚"
                ];
                
                // æ·»åŠ ä¸€äº›ä¸ªæ€§åŒ–å›åº”
                if (this.userMemory['ç”¨æˆ·åå­—']) {
                    thoughtfulResponses.push(
                        `${this.userMemory['ç”¨æˆ·åå­—']}ï¼Œå…³äºè¿™ä¸ªè¯é¢˜ï¼Œæˆ‘å¾ˆæƒ³å¬å¬ä½ çš„æƒ³æ³•ï¼`,
                        `æ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„äº¤æµï¼Œ${this.userMemory['ç”¨æˆ·åå­—']}ï¼Œæˆ‘è§‰å¾—ä½ å¯èƒ½ä¼šå¯¹è¿™ä¸ªè¯é¢˜æ„Ÿå…´è¶£...`
                    );
                }
                
                return thoughtfulResponses[Math.floor(Math.random() * thoughtfulResponses.length)];
            }
            
            // è·å–å­¦ä¹ æŠ¥å‘Š
            getLearningReport() {
                return {
                    totalConversations: this.conversationCount,
                    learnedItems: Object.keys(this.learnedKnowledge).length,
                    memoryItems: Object.keys(this.userMemory).length,
                    knowledgeBase: this.learnedKnowledge,
                    userMemory: this.userMemory
                };
            }
        }

        // åˆå§‹åŒ–K(ai)
        const kai = new KaiAI();
        
        // DOMå…ƒç´ 
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const typingIndicator = document.getElementById('typing-indicator');
        
        // åˆå§‹åŒ–æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
        kai.updateStats();
        
        // å‘é€æ¶ˆæ¯å‡½æ•°
        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
            addMessage(message, 'user');
            userInput.value = '';
            
            // æ˜¾ç¤º"æ­£åœ¨è¾“å…¥"æŒ‡ç¤ºå™¨
            typingIndicator.style.display = 'block';
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // æ¨¡æ‹ŸAIæ€è€ƒæ—¶é—´
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 1000));
            
            // éšè—"æ­£åœ¨è¾“å…¥"æŒ‡ç¤ºå™¨
            typingIndicator.style.display = 'none';
            
            // è·å–AIå›åº”
            const response = await kai.generateResponse(message);
            
            // æ·»åŠ AIå›åº”åˆ°èŠå¤©ç•Œé¢
            const aiMessageElement = addMessage(response, 'kai');
            
            // å¦‚æœæ˜¯å­¦ä¹ åˆ°çš„å†…å®¹ï¼Œæ·»åŠ å­¦ä¹ æŒ‡ç¤ºå™¨
            if (response.includes("ğŸ§ ") || response.includes("å­¦ä¹ ") || response.includes("è®°ä½")) {
                const learningIndicator = document.createElement('div');
                learningIndicator.className = 'learning-indicator';
                learningIndicator.textContent = 'K(ai) ä»è¿™æ¬¡å¯¹è¯ä¸­å­¦åˆ°äº†æ–°çŸ¥è¯†';
                aiMessageElement.appendChild(learningIndicator);
            }
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        // æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
        function addMessage(text, sender) {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}-message`;
            messageElement.textContent = text;
            chatContainer.appendChild(messageElement);
            return messageElement;
        }
        
        // äº‹ä»¶ç›‘å¬
        sendBtn.addEventListener('click', sendMessage);
        
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // åˆå§‹æ¬¢è¿æ¶ˆæ¯åæ›´æ–°ç»Ÿè®¡
        setTimeout(() => {
            kai.updateStats();
        }, 500);
    </script>
</body>
</html>
