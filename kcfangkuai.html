<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K(ai) - è‡ªä¸»å­¦ä¹ å…¨èƒ½åŠ©æ‰‹</title>
    <style>
        :root {
            --primary: #4facfe;
            --primary-dark: #3a9df5;
            --secondary: #00f2fe;
            --accent: #ff6b6b;
            --creative: #a78bfa;
            --learning: #51cf66;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #51cf66;
            --warning: #ffd43b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .kai-container {
            width: 100%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            display: flex;
            height: 90vh;
            position: relative;
        }

        .sidebar {
            width: 300px;
            background: var(--light);
            border-right: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            background: white;
        }

        .new-chat-btn {
            width: 100%;
            padding: 12px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3);
        }

        .new-chat-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(79, 172, 254, 0.4);
        }

        .knowledge-status {
            padding: 15px;
            background: white;
            border-bottom: 1px solid #e9ecef;
        }

        .knowledge-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .knowledge-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.8rem;
        }

        .knowledge-bar {
            flex: 1;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin: 0 10px;
            overflow: hidden;
        }

        .knowledge-progress {
            height: 100%;
            background: var(--learning);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .knowledge-percent {
            font-weight: 600;
            color: var(--dark);
            min-width: 30px;
            text-align: right;
        }

        .skills-panel {
            padding: 15px;
            background: white;
            border-bottom: 1px solid #e9ecef;
        }

        .skills-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .skills-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .skill-item {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.2);
            border-radius: 8px;
            padding: 8px;
            font-size: 0.75rem;
            text-align: center;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .skill-item:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: translateY(-2px);
        }

        .learning-log {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .learning-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .learning-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            font-size: 0.75rem;
        }

        .learning-item .time {
            font-size: 0.7rem;
            color: #666;
            margin-bottom: 4px;
        }

        .learning-item .content {
            color: var(--dark);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 22px;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.4rem;
            margin-bottom: 6px;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            opacity: 0.95;
            font-size: 1.05rem;
            font-weight: 500;
        }

        .status-indicator {
            position: absolute;
            top: 22px;
            right: 22px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.25);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            margin-right: 6px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }

        .chat-container {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 18px;
            background: #fafbfc;
        }

        .message {
            max-width: 85%;
            padding: 16px 20px;
            border-radius: 18px;
            line-height: 1.5;
            position: relative;
            animation: fadeIn 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 6px;
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3);
        }

        .kai-message {
            align-self: flex-start;
            background: white;
            color: var(--dark);
            border-bottom-left-radius: 6px;
            border: 1px solid #e9ecef;
        }

        .creative-content {
            background: rgba(167, 139, 250, 0.1);
            border-left: 4px solid var(--creative);
            padding: 12px 16px;
            margin-top: 10px;
            border-radius: 8px;
            font-style: italic;
        }

        .teaching-content {
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid var(--warning);
            padding: 12px 16px;
            margin-top: 10px;
            border-radius: 8px;
        }

        .recipe-content {
            background: rgba(255, 107, 107, 0.1);
            border-left: 4px solid var(--accent);
            padding: 12px 16px;
            margin-top: 10px;
            border-radius: 8px;
        }

        .learning-content {
            background: rgba(81, 207, 102, 0.1);
            border-left: 4px solid var(--learning);
            padding: 12px 16px;
            margin-top: 10px;
            border-radius: 8px;
        }

        .learning-indicator {
            font-size: 0.75rem;
            color: #666;
            margin-top: 8px;
            display: flex;
            align-items: center;
            font-weight: 500;
        }

        .learning-indicator::before {
            content: "ğŸ§ ";
            margin-right: 6px;
        }

        .input-container {
            padding: 22px;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 12px;
            background: white;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.03);
        }

        #user-input {
            flex: 1;
            padding: 14px 18px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 1rem;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        #user-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.15);
            background: white;
        }

        #send-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 52px;
            height: 52px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.3rem;
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3);
        }

        #send-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.08);
            box-shadow: 0 6px 15px rgba(79, 172, 254, 0.4);
        }

        #send-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .typing-indicator {
            align-self: flex-start;
            background: white;
            color: #666;
            padding: 14px 18px;
            border-radius: 18px;
            border-bottom-left-radius: 6px;
            display: none;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .typing-dots {
            display: inline-block;
        }

        .typing-dots span {
            animation: typing 1.4s infinite;
            display: inline-block;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }

        .empty-state {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #666;
            text-align: center;
            padding: 30px;
        }

        .empty-state h3 {
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1.5rem;
            color: var(--dark);
        }

        .empty-state p {
            font-size: 1rem;
            max-width: 400px;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .empty-state .features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            max-width: 500px;
        }

        .feature {
            background: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
        }

        .feature .icon {
            font-size: 1.8rem;
            margin-bottom: 8px;
        }

        .feature .title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .feature .desc {
            font-size: 0.85rem;
            color: #666;
        }

        @media (max-width: 768px) {
            .kai-container {
                flex-direction: column;
                height: 95vh;
            }
            
            .sidebar {
                width: 100%;
                height: 200px;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .skills-grid {
                display: flex;
                overflow-x: auto;
                padding-bottom: 5px;
            }
            
            .skill-item {
                flex: 0 0 auto;
                width: 100px;
                margin-right: 8px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .empty-state .features {
                grid-template-columns: 1fr;
            }
        }

        .skill-badge {
            display: inline-block;
            background: rgba(79, 172, 254, 0.1);
            color: var(--primary);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 8px;
            font-weight: 600;
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .quick-action {
            background: rgba(79, 172, 254, 0.1);
            color: var(--primary);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(79, 172, 254, 0.2);
        }

        .quick-action:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="kai-container">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <button class="new-chat-btn" id="new-chat-btn">
                    <span>+</span> æ–°èŠå¤©
                </button>
            </div>
            
            <div class="knowledge-status">
                <div class="knowledge-title">çŸ¥è¯†æŒæ¡ç¨‹åº¦</div>
                <div class="knowledge-item">
                    <span>æ–‡å­¦åˆ›ä½œ</span>
                    <div class="knowledge-bar">
                        <div class="knowledge-progress" id="literature-progress" style="width: 75%"></div>
                    </div>
                    <span class="knowledge-percent" id="literature-percent">75%</span>
                </div>
                <div class="knowledge-item">
                    <span>ç¾é£Ÿçƒ¹é¥ª</span>
                    <div class="knowledge-bar">
                        <div class="knowledge-progress" id="cooking-progress" style="width: 60%"></div>
                    </div>
                    <span class="knowledge-percent" id="cooking-percent">60%</span>
                </div>
                <div class="knowledge-item">
                    <span>ç¼–ç¨‹æŠ€æœ¯</span>
                    <div class="knowledge-bar">
                        <div class="knowledge-progress" id="programming-progress" style="width: 85%"></div>
                    </div>
                    <span class="knowledge-percent" id="programming-percent">85%</span>
                </div>
                <div class="knowledge-item">
                    <span>ç§‘å­¦çŸ¥è¯†</span>
                    <div class="knowledge-bar">
                        <div class="knowledge-progress" id="science-progress" style="width: 70%"></div>
                    </div>
                    <span class="knowledge-percent" id="science-percent">70%</span>
                </div>
            </div>
            
            <div class="skills-panel">
                <div class="skills-title">å…¨èƒ½æŠ€èƒ½</div>
                <div class="skills-grid">
                    <div class="skill-item" data-skill="poem">å†™è¯—åˆ›ä½œ</div>
                    <div class="skill-item" data-skill="essay">å†™ä½œæ–‡</div>
                    <div class="skill-item" data-skill="recipe">å‘æ˜ç¾é£Ÿ</div>
                    <div class="skill-item" data-skill="teach">æ•™å­¦æŒ‡å¯¼</div>
                    <div class="skill-item" data-skill="create">åˆ›æ„åˆ¶ä½œ</div>
                    <div class="skill-item" data-skill="story">æ•…äº‹åˆ›ä½œ</div>
                    <div class="skill-item" data-skill="advice">ä¸“ä¸šå»ºè®®</div>
                    <div class="skill-item" data-skill="explain">çŸ¥è¯†è§£ç­”</div>
                </div>
            </div>
            
            <div class="learning-log">
                <div class="learning-title">è‡ªä¸»å­¦ä¹ è®°å½•</div>
                <div id="learning-log-container">
                    <!-- å­¦ä¹ è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
        
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <div class="header">
                <h1>K(ai) è‡ªä¸»å­¦ä¹ ç‰ˆ</h1>
                <p>è‡ªä¸»ç§¯ç´¯çŸ¥è¯† Â· æŒç»­å­¦ä¹ è¿›åŒ– Â· å…¨èƒ½åˆ›ä½œåŠ©æ‰‹</p>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>å­¦ä¹ ä¸­</span>
                </div>
            </div>
            
            <div class="chat-container" id="chat-container">
                <div class="empty-state" id="empty-state">
                    <h3>æ¬¢è¿ä½¿ç”¨ K(ai) è‡ªä¸»å­¦ä¹ ç‰ˆ</h3>
                    <p>æˆ‘å…·å¤‡è‡ªä¸»å­¦ä¹ èƒ½åŠ›ï¼Œèƒ½å¤ŸæŒç»­ç§¯ç´¯æ–‡å­¦ã€çƒ¹é¥ªã€ç¼–ç¨‹ç­‰å„é¢†åŸŸçŸ¥è¯†ï¼Œå¹¶åº”ç”¨åˆ°åˆ›ä½œä¸­ã€‚æˆ‘ä¼šä¸»åŠ¨å­¦ä¹ æç™½ã€è‹è½¼ç­‰è¯—äººçš„é£æ ¼ï¼Œç ”ç©¶å„å›½æ–™ç†ï¼ŒæŒæ¡æœ€æ–°ç¼–ç¨‹æŠ€æœ¯ï¼</p>
                    <div class="features">
                        <div class="feature">
                            <div class="icon">ğŸ“š</div>
                            <div class="title">è‡ªä¸»å­¦ä¹ </div>
                            <div class="desc">æŒç»­ç§¯ç´¯å„é¢†åŸŸçŸ¥è¯†</div>
                        </div>
                        <div class="feature">
                            <div class="icon">ğŸ³</div>
                            <div class="title">ç¾é£Ÿç ”ç©¶</div>
                            <div class="desc">ç ”ç©¶å„å›½æ–™ç†ä¸åˆ›æ–°</div>
                        </div>
                        <div class="feature">
                            <div class="icon">ğŸ’»</div>
                            <div class="title">æŠ€æœ¯æŒæ¡</div>
                            <div class="desc">å­¦ä¹ æœ€æ–°ç¼–ç¨‹æŠ€æœ¯</div>
                        </div>
                        <div class="feature">
                            <div class="icon">ğŸ¨</div>
                            <div class="title">åˆ›ä½œåº”ç”¨</div>
                            <div class="desc">å°†çŸ¥è¯†åº”ç”¨äºåˆ›ä½œ</div>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <div class="quick-action" data-action="ç”¨æç™½çš„é£æ ¼å†™ä¸€é¦–è¯—">ç”¨æç™½çš„é£æ ¼å†™ä¸€é¦–è¯—</div>
                        <div class="quick-action" data-action="å‘æ˜ä¸€é“èåˆèœ">å‘æ˜ä¸€é“èåˆèœ</div>
                        <div class="quick-action" data-action="è§£é‡Šé‡å­è®¡ç®—">è§£é‡Šé‡å­è®¡ç®—</div>
                        <div class="quick-action" data-action="æ•™æˆ‘åšä¸€é“æ³•å›½èœ">æ•™æˆ‘åšä¸€é“æ³•å›½èœ</div>
                    </div>
                </div>
                <!-- èŠå¤©æ¶ˆæ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="typing-indicator" id="typing-indicator">
                K(ai)æ­£åœ¨æ€è€ƒå’Œå­¦ä¹ <span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>
            </div>
            
              <div class="input-container">
                <input type="text" id="user-input" placeholder="å‘Šè¯‰æˆ‘æ‚¨éœ€è¦ä»€ä¹ˆåˆ›ä½œæˆ–æ•™å­¦..." autocomplete="off">
                <button id="send-btn">â¤</button>
            </div>
        </div>
    </div>

    <script>
        // è‡ªä¸»å­¦ä¹ ç‰ˆ K(ai) AIæ ¸å¿ƒç±»
        class SelfLearningKaiAI {
            constructor() {
                this.name = "K(ai)";
                this.version = "7.0 - è‡ªä¸»å­¦ä¹ ç‰ˆ";
                this.currentChatId = this.generateChatId();
                this.chatSessions = this.loadChatSessions();
                this.knowledgeBase = this.loadKnowledgeBase();
                this.learningLog = this.loadLearningLog();
                
                // åˆå§‹åŒ–çŸ¥è¯†åº“
                this.initializeKnowledgeBase();
                
                // åˆå§‹åŒ–å½“å‰èŠå¤©
                if (!this.chatSessions[this.currentChatId]) {
                    this.chatSessions[this.currentChatId] = {
                        id: this.currentChatId,
                        title: "æ–°å¯¹è¯",
                        messages: [],
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };
                    this.saveChatSessions();
                }
                
                // å¼€å§‹è‡ªä¸»å­¦ä¹ 
                this.startSelfLearning();
            }
            
            // ç”ŸæˆèŠå¤©ID
            generateChatId() {
                return 'chat_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }
            
            // åŠ è½½èŠå¤©ä¼šè¯
            loadChatSessions() {
                try {
                    const saved = localStorage.getItem('kai_chat_sessions');
                    return saved ? JSON.parse(saved) : {};
                } catch (e) {
                    return {};
                }
            }
            
            // ä¿å­˜èŠå¤©ä¼šè¯
            saveChatSessions() {
                try {
                    localStorage.setItem('kai_chat_sessions', JSON.stringify(this.chatSessions));
                    this.renderChatHistory();
                } catch (e) {
                    console.error('ä¿å­˜èŠå¤©ä¼šè¯å¤±è´¥:', e);
                }
            }
            
            // åŠ è½½çŸ¥è¯†åº“
            loadKnowledgeBase() {
                try {
                    const saved = localStorage.getItem('kai_knowledge_base');
                    return saved ? JSON.parse(saved) : {
                        literature: {
                            poets: {},
                            styles: {},
                            techniques: {}
                        },
                        cooking: {
                            cuisines: {},
                            techniques: {},
                            ingredients: {}
                        },
                        programming: {
                            languages: {},
                            frameworks: {},
                            concepts: {}
                        },
                        science: {
                            physics: {},
                            biology: {},
                            chemistry: {}
                        }
                    };
                } catch (e) {
                    return {
                        literature: {
                            poets: {},
                            styles: {},
                            techniques: {}
                        },
                        cooking: {
                            cuisines: {},
                            techniques: {},
                            ingredients: {}
                        },
                        programming: {
                            languages: {},
                            frameworks: {},
                            concepts: {}
                        },
                        science: {
                            physics: {},
                            biology: {},
                            chemistry: {}
                        }
                    };
                }
            }
            
            // ä¿å­˜çŸ¥è¯†åº“
            saveKnowledgeBase() {
                try {
                    localStorage.setItem('kai_knowledge_base', JSON.stringify(this.knowledgeBase));
                    this.updateKnowledgeStatus();
                } catch (e) {
                    console.error('ä¿å­˜çŸ¥è¯†åº“å¤±è´¥:', e);
                }
            }
            
            // åŠ è½½å­¦ä¹ è®°å½•
            loadLearningLog() {
                try {
                    const saved = localStorage.getItem('kai_learning_log');
                    return saved ? JSON.parse(saved) : [];
                } catch (e) {
                    return [];
                }
            }
            
            // ä¿å­˜å­¦ä¹ è®°å½•
            saveLearningLog() {
                try {
                    localStorage.setItem('kai_learning_log', JSON.stringify(this.learningLog));
                    this.renderLearningLog();
                } catch (e) {
                    console.error('ä¿å­˜å­¦ä¹ è®°å½•å¤±è´¥:', e);
                }
            }
            
            // åˆå§‹åŒ–çŸ¥è¯†åº“
            initializeKnowledgeBase() {
                // å¦‚æœçŸ¥è¯†åº“ä¸ºç©ºï¼Œæ·»åŠ åˆå§‹çŸ¥è¯†
                if (Object.keys(this.knowledgeBase.literature.poets).length === 0) {
                    this.knowledgeBase.literature.poets = {
                        "æç™½": {
                            style: "è±ªæ”¾é£˜é€¸ï¼Œæƒ³è±¡ä¸°å¯Œ",
                            themes: ["é¥®é…’", "å±±æ°´", "æœˆäº®", "å‹æƒ…"],
                            techniques: ["å¤¸å¼ ", "æ¯”å–»", "å¯¹ä»—"],
                            representative: ["ã€Šé™å¤œæ€ã€‹", "ã€Šå°†è¿›é…’ã€‹", "ã€Šæœ›åºå±±ç€‘å¸ƒã€‹"]
                        },
                        "æœç”«": {
                            style: "æ²‰éƒé¡¿æŒ«ï¼Œå…³æ³¨ç°å®",
                            themes: ["ç¤¾ä¼šç°å®", "äººæ°‘ç–¾è‹¦", "å®¶å›½æƒ…æ€€"],
                            techniques: ["å†™å®", "å¯¹æ¯”", "è±¡å¾"],
                            representative: ["ã€Šæ˜¥æœ›ã€‹", "ã€Šç™»é«˜ã€‹", "ã€ŠèŒ…å±‹ä¸ºç§‹é£æ‰€ç ´æ­Œã€‹"]
                        },
                        "è‹è½¼": {
                            style: "è±ªæ”¾æ´’è„±ï¼Œæ„å¢ƒå¼€é˜”",
                            themes: ["äººç”Ÿå“²ç†", "è‡ªç„¶å±±æ°´", "æ€€å¤"],
                            techniques: ["æ¯”å–»", "ç”¨å…¸", "è®®è®º"],
                            representative: ["ã€Šæ°´è°ƒæ­Œå¤´ã€‹", "ã€Šå¿µå¥´å¨‡Â·èµ¤å£æ€€å¤ã€‹", "ã€Šæ±ŸåŸå­Â·å¯†å·å‡ºçŒã€‹"]
                        }
                    };
                    
                    this.knowledgeBase.cooking.cuisines = {
                        "å·èœ": {
                            characteristics: "éº»è¾£é²œé¦™ï¼Œå£å‘³å¤šå˜",
                            techniques: ["ç‚’", "ç…®", "çƒ§", "è’¸"],
                            representative: ["éº»å©†è±†è…", "å®«ä¿é¸¡ä¸", "æ°´ç…®é±¼"]
                        },
                        "ç²¤èœ": {
                            characteristics: "æ¸…æ·¡é²œç¾ï¼Œè®²ç©¶ç«å€™",
                            techniques: ["è’¸", "ç‚–", "ç…®", "ç‚’"],
                            representative: ["ç™½åˆ‡é¸¡", "æ¸…è’¸é±¼", "å‰çƒ§"]
                        },
                        "æ³•å›½èœ": {
                            characteristics: "ç²¾è‡´ç»†è…»ï¼Œé…±æ±ä¸°å¯Œ",
                            techniques: ["çƒ¤", "ç‚–", "ç…", "ç„—"],
                            representative: ["é¹…è‚", "èœ—ç‰›", "å¥¶æ²¹è˜‘è‡æ±¤"]
                        }
                    };
                    
                    this.saveKnowledgeBase();
                }
            }
            
            // å¼€å§‹è‡ªä¸»å­¦ä¹ 
            startSelfLearning() {
                // æ¨¡æ‹Ÿè‡ªä¸»å­¦ä¹ è¿‡ç¨‹
                setTimeout(() => {
                    this.learnNewKnowledge("literature", "å­¦ä¹ äº†ç‹ç»´çš„å±±æ°´è¯—é£æ ¼");
                }, 5000);
                
                setTimeout(() => {
                    this.learnNewKnowledge("cooking", "ç ”ç©¶äº†æ„å¤§åˆ©é¢çš„åˆ¶ä½œæŠ€å·§");
                }, 10000);
                
                setTimeout(() => {
                    this.learnNewKnowledge("programming", "æŒæ¡äº†React Hooksçš„ä½¿ç”¨æ–¹æ³•");
                }, 15000);
            }
            
            // å­¦ä¹ æ–°çŸ¥è¯†
            learnNewKnowledge(category, description) {
                const timestamp = new Date().toLocaleString();
                this.learningLog.unshift({
                    time: timestamp,
                    category: category,
                    content: description
                });
                
                // é™åˆ¶å­¦ä¹ è®°å½•æ•°é‡
                if (this.learningLog.length > 20) {
                    this.learningLog = this.learningLog.slice(0, 20);
                }
                
                // æ›´æ–°çŸ¥è¯†åº“
                this.updateKnowledgeBase(category);
                
                this.saveLearningLog();
                this.saveKnowledgeBase();
            }
            
            // æ›´æ–°çŸ¥è¯†åº“
            updateKnowledgeBase(category) {
                // æ¨¡æ‹ŸçŸ¥è¯†å¢é•¿
                const growth = Math.random() * 5;
                switch(category) {
                    case "literature":
                        if (!this.knowledgeBase.literature.progress) this.knowledgeBase.literature.progress = 75;
                        this.knowledgeBase.literature.progress = Math.min(100, this.knowledgeBase.literature.progress + growth);
                        break;
                    case "cooking":
                        if (!this.knowledgeBase.cooking.progress) this.knowledgeBase.cooking.progress = 60;
                        this.knowledgeBase.cooking.progress = Math.min(100, this.knowledgeBase.cooking.progress + growth);
                        break;
                    case "programming":
                        if (!this.knowledgeBase.programming.progress) this.knowledgeBase.programming.progress = 85;
                        this.knowledgeBase.programming.progress = Math.min(100, this.knowledgeBase.programming.progress + growth);
                        break;
                    case "science":
                        if (!this.knowledgeBase.science.progress) this.knowledgeBase.science.progress = 70;
                        this.knowledgeBase.science.progress = Math.min(100, this.knowledgeBase.science.progress + growth);
                        break;
                }
            }
            
            // åˆ›å»ºæ–°èŠå¤©
            createNewChat() {
                this.currentChatId = this.generateChatId();
                this.chatSessions[this.currentChatId] = {
                    id: this.currentChatId,
                    title: "æ–°å¯¹è¯",
                    messages: [],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                this.saveChatSessions();
                return this.currentChatId;
            }
            
            // åˆ‡æ¢åˆ°æŒ‡å®šèŠå¤©
            switchToChat(chatId) {
                if (this.chatSessions[chatId]) {
                    this.currentChatId = chatId;
                    return true;
                }
                return false;
            }
            
            // è·å–å½“å‰èŠå¤©
            getCurrentChat() {
                return this.chatSessions[this.currentChatId];
            }
            
            // è·å–æ‰€æœ‰èŠå¤©ä¼šè¯
            getAllChats() {
                return Object.values(this.chatSessions).sort((a, b) => 
                    new Date(b.updatedAt) - new Date(a.updatedAt)
                );
            }
            
            // æ›´æ–°èŠå¤©æ ‡é¢˜
            updateChatTitle(chatId, userMessage) {
                if (this.chatSessions[chatId] && this.chatSessions[chatId].title === "æ–°å¯¹è¯") {
                    const title = userMessage.length > 20 ? userMessage.substring(0, 20) + '...' : userMessage;
                    this.chatSessions[chatId].title = title;
                    this.chatSessions[chatId].updatedAt = new Date().toISOString();
                    this.saveChatSessions();
                }
            }
            
            // æ·»åŠ æ¶ˆæ¯åˆ°å½“å‰èŠå¤©
            addMessageToCurrentChat(sender, content) {
                const chat = this.getCurrentChat();
                if (chat) {
                    chat.messages.push({
                        sender: sender,
                        content: content,
                        timestamp: new Date().toISOString()
                    });
                    chat.updatedAt = new Date().toISOString();
                    this.saveChatSessions();
                    
                    if (sender === 'user' && chat.messages.length === 1) {
                        this.updateChatTitle(this.currentChatId, content);
                    }
                }
            }
            
            // å…¨èƒ½æ„å›¾è¯†åˆ«
            understandIntent(userInput) {
                const input = userInput.toLowerCase().trim();
                
                // æ–‡å­¦åˆ›ä½œç±»
                if (input.includes('è¯—') || input.includes('è¯—æ­Œ') || input.includes('å†™è¯—') || 
                    input.includes('æç™½') || input.includes('æœç”«') || input.includes('è‹è½¼')) {
                    return { type: 'poem', theme: this.extractTheme(input), style: this.extractStyle(input) };
                }
                
                if (input.includes('ä½œæ–‡') || input.includes('æ–‡ç« ') || input.includes('å†™ä½œ') || input.includes('æ•£æ–‡')) {
                    return { type: 'essay', topic: this.extractTopic(input) };
                }
                
                if (input.includes('æ•…äº‹') || input.includes('å°è¯´') || input.includes('ç¼–æ•…äº‹')) {
                    return { type: 'story', genre: this.extractGenre(input) };
                }
                
                // ç¾é£Ÿç±»
                if (input.includes('é£Ÿè°±') || input.includes('èœ') || input.includes('çƒ¹é¥ª') || 
                    input.includes('ç¾é£Ÿ') || input.includes('åšé¥­') || input.includes('æ–™ç†') ||
                    input.includes('æ³•å›½èœ') || input.includes('å·èœ') || input.includes('æ„å¤§åˆ©')) {
                    return { type: 'recipe', dish: this.extractDish(input), cuisine: this.extractCuisine(input) };
                }
                
                // æ•™å­¦ç±»
                if (input.includes('æ•™') || input.includes('å¦‚ä½•') || input.includes('æ€ä¹ˆ') || 
                    input.includes('æ•™ç¨‹') || input.includes('æŒ‡å¯¼') || input.includes('æ­¥éª¤')) {
                    return { type: 'teach', subject: this.extractSubject(input) };
                }
                
                // åˆ›æ„åˆ¶ä½œç±»
                if (input.includes('åˆ¶ä½œ') || input.includes('åš') || input.includes('æ‰‹å·¥') || 
                    input.includes('DIY') || input.includes('åˆ›é€ ') || input.includes('å‘æ˜')) {
                    return { type: 'create', project: this.extractProject(input) };
                }
                
                // çŸ¥è¯†è§£ç­”ç±»
                if (input.includes('ä»€ä¹ˆ') || input.includes('ä¸ºä»€ä¹ˆ') || input.includes('æ€ä¹ˆ') || 
                    input.includes('å¦‚ä½•') || input.includes('è§£é‡Š') || input.includes('è¯´æ˜') ||
                    input.includes('é‡å­') || input.includes('äººå·¥æ™ºèƒ½') || input.includes('ç¼–ç¨‹')) {
                    return { type: 'explain', question: input };
                }
                
                // å»ºè®®ç±»
                if (input.includes('å»ºè®®') || input.includes('æ¨è') || input.includes('æ„è§') || 
                    input.includes('åº”è¯¥') || input.includes('æ€ä¹ˆåŠ')) {
                    return { type: 'advice', area: this.extractArea(input) };
                }
                
                return { type: 'conversation' };
            }
            
            // æå–ä¸»é¢˜
            extractTheme(input) {
                const themes = ['æ˜¥å¤©', 'å¤å¤©', 'ç§‹å¤©', 'å†¬å¤©', 'çˆ±æƒ…', 'å‹è°Š', 'å®¶ä¹¡', 'è‡ªç„¶', 'æ˜Ÿç©º', 'å¤§æµ·', 'æœˆäº®', 'å¤ªé˜³'];
                for (let theme of themes) {
                    if (input.includes(theme)) return theme;
                }
                return 'ç”Ÿæ´»';
            }
            
            // æå–é£æ ¼
            extractStyle(input) {
                if (input.includes('æç™½')) return 'æç™½';
                if (input.includes('æœç”«')) return 'æœç”«';
                if (input.includes('è‹è½¼')) return 'è‹è½¼';
                return null;
            }
            
            // æå–ä¸»é¢˜
            extractTopic(input) {
                const topics = ['AI', 'ç§‘æŠ€', 'ç¯å¢ƒ', 'æ•™è‚²', 'å¥åº·', 'æœªæ¥', 'æ¢¦æƒ³', 'æˆåŠŸ', 'å‹è°Š', 'å®¶åº­'];
                for (let topic of topics) {
                    if (input.includes(topic)) return topic;
                }
                return 'ç”Ÿæ´»æ„Ÿæ‚Ÿ';
            }
            
            // æå–ä½“è£
            extractGenre(input) {
                if (input.includes('ç«¥è¯')) return 'ç«¥è¯';
                if (input.includes('ç§‘å¹»')) return 'ç§‘å¹»';
                if (input.includes('æ‚¬ç–‘')) return 'æ‚¬ç–‘';
                if (input.includes('çˆ±æƒ…')) return 'çˆ±æƒ…';
                return 'ç”Ÿæ´»';
            }
            
            // æå–èœè‚´
            extractDish(input) {
                if (input.includes('è›‹ç³•') || input.includes('ç”œç‚¹')) return 'ç”œç‚¹';
                if (input.includes('æ±¤')) return 'æ±¤';
                if (input.includes('ç‚’é¥­') || input.includes('ç±³é¥­')) return 'ä¸»é£Ÿ';
                if (input.includes('æ²™æ‹‰')) return 'æ²™æ‹‰';
                if (input.includes('æ„å¤§åˆ©é¢')) return 'æ„å¤§åˆ©é¢';
                return 'åˆ›æ„èœ';
            }
            
            // æå–èœç³»
            extractCuisine(input) {
                if (input.includes('æ³•å›½èœ') || input.includes('æ³•å¼')) return 'æ³•å›½èœ';
                if (input.includes('å·èœ') || input.includes('å››å·')) return 'å·èœ';
                if (input.includes('ç²¤èœ') || input.includes('å¹¿ä¸œ')) return 'ç²¤èœ';
                if (input.includes('æ„å¤§åˆ©') || input.includes('æ„å¼')) return 'æ„å¤§åˆ©èœ';
                return null;
            }
            
            // æå–å­¦ç§‘
            extractSubject(input) {
                if (input.includes('æ•°å­¦')) return 'æ•°å­¦';
                if (input.includes('ç¼–ç¨‹')) return 'ç¼–ç¨‹';
                if (input.includes('è‹±è¯­')) return 'è‹±è¯­';
                if (input.includes('ç§‘å­¦')) return 'ç§‘å­¦';
                if (input.includes('ç”»ç”»') || input.includes('ç»˜ç”»')) return 'è‰ºæœ¯';
                return 'ç”Ÿæ´»æŠ€èƒ½';
            }
            
            // æå–é¡¹ç›®
            extractProject(input) {
                if (input.includes('å¡ç‰‡') || input.includes('è´ºå¡')) return 'æ‰‹å·¥å¡ç‰‡';
                if (input.includes('ç©å…·')) return 'ç©å…·';
                if (input.includes('è£…é¥°')) return 'è£…é¥°å“';
                return 'åˆ›æ„ä½œå“';
            }
            
            // æå–é¢†åŸŸ
            extractArea(input) {
                if (input.includes('å­¦ä¹ ')) return 'å­¦ä¹ ';
                if (input.includes('å·¥ä½œ')) return 'å·¥ä½œ';
                if (input.includes('ç”Ÿæ´»')) return 'ç”Ÿæ´»';
                if (input.includes('å¥åº·')) return 'å¥åº·';
                return 'ä¸ªäººå‘å±•';
            }
            
            // å…¨èƒ½å›åº”ç”Ÿæˆ
            async generateResponse(userInput) {
                // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å½“å‰èŠå¤©
                this.addMessageToCurrentChat('user', userInput);
                
                const intent = this.understandIntent(userInput);
                
                let response;
                let content = '';
                let learnFromThis = false;
                
                // æ ¹æ®æ„å›¾ç”Ÿæˆå›åº”
                switch (intent.type) {
                    case 'poem':
                        response = this.generatePoem(intent.theme, intent.style);
                        content = 'poem';
                        learnFromThis = true;
                        break;
                    
                    case 'essay':
                        response = this.generateEssay(intent.topic);
                        content = 'essay';
                        learnFromThis = true;
                        break;
                    
                    case 'story':
                        response = this.generateStory(intent.genre);
                        content = 'story';
                        learnFromThis = true;
                        break;
                    
                    case 'recipe':
                        response = this.generateRecipe(intent.dish, intent.cuisine);
                        content = 'recipe';
                        learnFromThis = true;
                        break;
                    
                    case 'teach':
                        response = this.generateTeaching(intent.subject);
                        content = 'teach';
                        learnFromThis = true;
                        break;
                    
                    case 'create':
                        response = this.generateCreation(intent.project);
                        content = 'create';
                        break;
                    
                    case 'explain':
                        response = this.generateExplanation(intent.question);
                        content = 'explain';
                        learnFromThis = true;
                        break;
                    
                    case 'advice':
                        response = this.generateAdvice(intent.area);
                        content = 'advice';
                        break;
                    
                    case 'conversation':
                    default:
                        response = this.generateConversationResponse(userInput);
                        break;
                }
                
                // å¦‚æœè¿™æ˜¯ä¸€ä¸ªå­¦ä¹ æœºä¼šï¼Œè®°å½•å­¦ä¹ 
                if (learnFromThis) {
                    this.learnFromInteraction(userInput, intent.type);
                }
                
                // æ·»åŠ AIå›åº”åˆ°å½“å‰èŠå¤©
                this.addMessageToCurrentChat('kai', response.content);
                
                return { 
                    response: response.content, 
                    contentType: content,
                    title: response.title || ''
                };
            }
            
            // ç”Ÿæˆè¯—æ­Œ
            generatePoem(theme, style) {
                let poemStyle = "ç°ä»£";
                let poetInfo = "";
                
                if (style && this.knowledgeBase.literature.poets[style]) {
                    poemStyle = style;
                    const poet = this.knowledgeBase.literature.poets[style];
                    poetInfo = `\n\nï¼ˆæ¨¡ä»¿${style}çš„${poet.style}é£æ ¼åˆ›ä½œï¼‰`;
                }
                
                const poems = {
                    'æ˜¥å¤©': {
                        title: "ã€Šæ˜¥ä¹‹éŸµã€‹",
                        content: `æ˜¥é£è½»æ‹‚é¢ï¼ŒèŠ±å¼€æ»¡å›­é¦™ã€‚
ç‡•å­å½’æ¥æ—¶ï¼Œä¸‡ç‰©å¤è‹å¿™ã€‚
ç»†é›¨æ¶¦æ–°èŠ½ï¼Œé˜³å…‰ç…§å¤§åœ°ã€‚
æ˜¥å¤©å¤šç¾å¥½ï¼Œå¿ƒä¸­æ»¡å¸Œæœ›ã€‚`
                    },
                    'å¤å¤©': {
                        title: "ã€Šå¤ä¹‹æ‹ã€‹",
                        content: `å¤æ—¥ç‚ç‚ç…§ï¼Œè‰é¸£æ ‘æ¢¢å¤´ã€‚
è·èŠ±æ± ä¸­å¼€ï¼Œæ¸…é£é€å‡‰æ„ã€‚
è¥¿ç“œç”œå¦‚èœœï¼Œå†°é¥®è§£æš‘æ°”ã€‚
å¤æ—¥è™½ç‚çƒ­ï¼Œä¹è¶£äº¦æ— ç©·ã€‚`
                    }
                };
                
                const poem = poems[theme] || poems['æ˜¥å¤©'];
                return {
                    content: `ä¸ºæ‚¨åˆ›ä½œäº†ä¸€é¦–å…³äº${theme}çš„è¯—æ­Œ${poemStyle !== "ç°ä»£" ? `ï¼Œæ¨¡ä»¿${poemStyle}çš„é£æ ¼` : ''}ï¼š\n\n<div class="creative-content">${poem.title}\n\n${poem.content}${poetInfo}</div>\n\nå¸Œæœ›æ‚¨å–œæ¬¢è¿™é¦–è¯—æ­Œï¼`,
                    title: poem.title
                };
            }
            
            // ç”Ÿæˆæ–‡ç« 
            generateEssay(topic) {
                const essays = {
                    'AI': {
                        title: "äººå·¥æ™ºèƒ½ä¸æœªæ¥ç¤¾ä¼š",
                        content: `äººå·¥æ™ºèƒ½æ­£ä»¥å‰æ‰€æœªæœ‰çš„é€Ÿåº¦æ”¹å˜ç€æˆ‘ä»¬çš„ç”Ÿæ´»ã€‚ä»æ™ºèƒ½æ‰‹æœºçš„è¯­éŸ³åŠ©æ‰‹åˆ°è‡ªåŠ¨é©¾é©¶æ±½è½¦ï¼Œä»æ™ºèƒ½åŒ»ç–—è¯Šæ–­åˆ°ä¸ªæ€§åŒ–æ•™è‚²ï¼ŒAIæŠ€æœ¯æ­£åœ¨å„ä¸ªé¢†åŸŸå‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚

åœ¨åŒ»ç–—é¢†åŸŸï¼ŒAIå¯ä»¥å¸®åŠ©åŒ»ç”Ÿåˆ†æåŒ»å­¦å½±åƒï¼Œæé«˜è¯Šæ–­çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚åœ¨æ•™è‚²é¢†åŸŸï¼ŒAIå¯ä»¥æ ¹æ®å­¦ç”Ÿçš„å­¦ä¹ æƒ…å†µæä¾›ä¸ªæ€§åŒ–çš„å­¦ä¹ æ–¹æ¡ˆã€‚åœ¨äº¤é€šé¢†åŸŸï¼Œè‡ªåŠ¨é©¾é©¶æŠ€æœ¯æœ‰æœ›å¤§å¹…å‡å°‘äº¤é€šäº‹æ•…ã€‚

ç„¶è€Œï¼ŒAIçš„å‘å±•ä¹Ÿå¸¦æ¥äº†ä¸€äº›æŒ‘æˆ˜ï¼Œå¦‚å°±ä¸šå¸‚åœºçš„å˜åŒ–ã€æ•°æ®éšç§é—®é¢˜ä»¥åŠä¼¦ç†é“å¾·è€ƒé‡ã€‚æˆ‘ä»¬éœ€è¦åœ¨äº«å—AIå¸¦æ¥ä¾¿åˆ©çš„åŒæ—¶ï¼Œè®¤çœŸæ€è€ƒå¦‚ä½•åº”å¯¹è¿™äº›æŒ‘æˆ˜ã€‚

æœªæ¥ï¼Œäººå·¥æ™ºèƒ½å°†ç»§ç»­æ·±åŒ–ä¸äººç±»ç¤¾ä¼šçš„èåˆã€‚æˆ‘ä»¬åº”è¯¥ä»¥å¼€æ”¾ã€ç†æ€§çš„æ€åº¦è¿æ¥AIæ—¶ä»£ï¼Œè®©äººå·¥æ™ºèƒ½çœŸæ­£ä¸ºäººç±»ç¦ç¥‰æœåŠ¡ã€‚`
                    },
                    'ç¯å¢ƒ': {
                        title: "ä¿æŠ¤ç¯å¢ƒï¼Œå…±å»ºç¾å¥½å®¶å›­",
                        content: `ç¯å¢ƒé—®é¢˜æ˜¯å½“ä»Šä¸–ç•Œé¢ä¸´çš„é‡å¤§æŒ‘æˆ˜ä¹‹ä¸€ã€‚éšç€å·¥ä¸šåŒ–å’ŒåŸå¸‚åŒ–è¿›ç¨‹çš„åŠ é€Ÿï¼Œç©ºæ°”æ±¡æŸ“ã€æ°´èµ„æºçŸ­ç¼ºã€ç”Ÿç‰©å¤šæ ·æ€§ä¸§å¤±ç­‰é—®é¢˜æ—¥ç›Šä¸¥é‡ã€‚

ä¿æŠ¤ç¯å¢ƒéœ€è¦ä»æ¯ä¸ªäººåšèµ·ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å‡å°‘ä½¿ç”¨ä¸€æ¬¡æ€§å¡‘æ–™åˆ¶å“ã€èŠ‚çº¦ç”¨æ°´ç”¨ç”µã€é€‰æ‹©å…¬å…±äº¤é€šç­‰æ–¹å¼ï¼Œä¸ºç¯å¢ƒä¿æŠ¤è´¡çŒ®è‡ªå·±çš„ä¸€ä»½åŠ›é‡ã€‚

æ”¿åºœå’Œä¼ä¸šä¹Ÿåº”å½“æ‰¿æ‹…èµ·ç¯å¢ƒä¿æŠ¤çš„è´£ä»»ï¼ŒåŠ å¤§ç¯ä¿æŠ•å…¥ï¼Œå‘å±•ç»¿è‰²ç§‘æŠ€ï¼Œæ¨åŠ¨å¯æŒç»­å‘å±•ã€‚

åªæœ‰æˆ‘ä»¬å…±åŒåŠªåŠ›ï¼Œæ‰èƒ½ä¸ºå­å­™åä»£ç•™ä¸‹ä¸€ä¸ªç»¿æ°´é’å±±çš„ç¾å¥½å®¶å›­ã€‚è®©æˆ‘ä»¬è¡ŒåŠ¨èµ·æ¥ï¼Œä¿æŠ¤æˆ‘ä»¬å…±åŒçš„åœ°çƒï¼`
                    }
                };
                
                const essay = essays[topic] || {
                    title: `å…³äº${topic}çš„æ€è€ƒ`,
                    content: `${topic}æ˜¯ä¸€ä¸ªå€¼å¾—æ·±å…¥æ¢è®¨çš„è¯é¢˜ã€‚åœ¨è¿™ä¸ªå¿«é€Ÿå˜åŒ–çš„æ—¶ä»£ï¼Œæˆ‘ä»¬éœ€è¦å¯¹${topic}æœ‰æ›´å…¨é¢çš„è®¤è¯†å’Œç†è§£ã€‚

é¦–å…ˆï¼Œ${topic}æ¶‰åŠåˆ°æˆ‘ä»¬ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ï¼Œä»ä¸ªäººåˆ°ç¤¾ä¼šï¼Œä»å±€éƒ¨åˆ°å…¨å±€ï¼Œéƒ½æœ‰ç€é‡è¦çš„å½±å“ã€‚

å…¶æ¬¡ï¼Œé¢å¯¹${topic}å¸¦æ¥çš„æœºé‡å’ŒæŒ‘æˆ˜ï¼Œæˆ‘ä»¬éœ€è¦é‡‡å–ç§¯æçš„æ€åº¦å’Œè¡ŒåŠ¨ã€‚é€šè¿‡å­¦ä¹ å’Œå®è·µï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°åº”å¯¹${topic}ç›¸å…³çš„é—®é¢˜ã€‚

æœ€åï¼Œ${topic}çš„æœªæ¥å‘å±•å€¼å¾—æˆ‘ä»¬æœŸå¾…ã€‚ç›¸ä¿¡é€šè¿‡å…±åŒåŠªåŠ›ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨${topic}é¢†åŸŸå–å¾—æ›´å¤§çš„è¿›æ­¥å’Œæˆå°±ã€‚`
                };
                
                return {
                    content: `ä¸ºæ‚¨åˆ›ä½œäº†ä¸€ç¯‡å…³äº${topic}çš„ä½œæ–‡ï¼š\n\n<div class="creative-content"><h3>${essay.title}</h3>\n\n${essay.content}</div>\n\nå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™æ‚¨å¸¦æ¥å¯å‘ï¼`,
                    title: essay.title
                };
            }
            
            // ç”Ÿæˆæ•…äº‹
            generateStory(genre) {
                const stories = {
                    'ç«¥è¯': {
                        title: "é­”æ³•æ£®æ—çš„å†’é™©",
                        content: `åœ¨é¥è¿œçš„é­”æ³•æ£®æ—é‡Œï¼Œä½ç€ä¸€åªåå«å°çµçš„å°ç‹ç‹¸ã€‚å°çµæœ‰ç€ç«çº¢çš„çš®æ¯›å’Œèªæ˜çš„å¤´è„‘ï¼Œä½†å®ƒæœ€å¤§çš„æ¢¦æƒ³æ˜¯æ‰¾åˆ°ä¼ è¯´ä¸­çš„æ™ºæ…§ä¹‹æ³‰ã€‚

ä¸€å¤©ï¼Œå°çµåœ¨æ£®æ—é‡Œé‡åˆ°äº†ä¸€åªè¿·è·¯çš„å°é¸Ÿã€‚å°é¸Ÿå‘Šè¯‰å°çµï¼Œå®ƒçš„å®¶è¢«æš´é£é›¨æ‘§æ¯äº†ï¼Œç°åœ¨æ— å®¶å¯å½’ã€‚å°çµå†³å®šå¸®åŠ©å°é¸Ÿæ‰¾åˆ°æ–°å®¶ã€‚

å®ƒä»¬ä¸€èµ·ç©¿è¶Šäº†è¿·é›¾æ²¼æ³½ï¼Œæ”€ä¸Šäº†å½©è™¹å±±ï¼Œæœ€ç»ˆåœ¨æ˜Ÿç©ºæ¹–è¾¹æ‰¾åˆ°äº†ä¸€æ£µå®Œç¾çš„å¤§æ ‘ã€‚å°é¸Ÿåœ¨è¿™é‡Œå»ºäº†æ–°å®¶ï¼Œå®ƒä»¬ä¹Ÿæˆä¸ºäº†æœ€å¥½çš„æœ‹å‹ã€‚

å½“å°çµå‡†å¤‡ç»§ç»­å¯»æ‰¾æ™ºæ…§ä¹‹æ³‰æ—¶ï¼Œå°é¸Ÿé€ç»™å®ƒä¸€æ ¹é—ªäº®çš„ç¾½æ¯›ä½œä¸ºæ„Ÿè°¢ã€‚å°±åœ¨è¿™æ—¶ï¼Œç¾½æ¯›å‘å‡ºäº†è€€çœ¼çš„å…‰èŠ’ï¼ŒæŒ‡å¼•ç€å°çµæ‰¾åˆ°äº†æ™ºæ…§ä¹‹æ³‰ã€‚

å°çµç»ˆäºæ˜ç™½ï¼ŒçœŸæ­£çš„æ™ºæ…§ä¸åœ¨äºæ‰¾åˆ°ç¥å¥‡çš„æ³‰æ°´ï¼Œè€Œåœ¨äºå¸®åŠ©ä»–äººæ—¶è·å¾—çš„å¿«ä¹å’Œå‹è°Šã€‚`
                    },
                    'ç§‘å¹»': {
                        title: "æ—¶é—´æ—…è¡Œè€…çš„æŠ‰æ‹©",
                        content: `å…¬å…ƒ2157å¹´ï¼Œæ—¶é—´æ—…è¡ŒæŠ€æœ¯ç»ˆäºæˆç†Ÿã€‚å¹´è½»çš„æ—¶é—´æ¢å‘˜ææ™¨è¢«æ´¾å¾€2023å¹´ï¼Œæ‰§è¡Œä¸€é¡¹å…³é”®ä»»åŠ¡ï¼šé˜»æ­¢ä¸€åœºå³å°†å‘ç”Ÿçš„ç§‘æŠ€ç¾éš¾ã€‚

ææ™¨é¡ºåˆ©æŠµè¾¾2023å¹´ï¼Œå´å‘ç°äº‹æƒ…è¿œæ¯”æƒ³è±¡ä¸­å¤æ‚ã€‚ä»–é‡åˆ°äº†å–„è‰¯çš„ç§‘å­¦å®¶æ—æ•™æˆï¼Œæ—æ•™æˆæ­£åœ¨ç ”å‘çš„æ­£æ˜¯å¯¼è‡´æœªæ¥ç¾éš¾çš„æŠ€æœ¯ã€‚

åœ¨ç›¸å¤„ä¸­ï¼Œææ™¨è¢«æ—æ•™æˆçš„çœŸè¯šå’Œå¯¹ç§‘å­¦çš„çƒ­çˆ±æ‰€æ„ŸåŠ¨ã€‚ä»–å¼€å§‹æ€€ç–‘è‡ªå·±çš„ä»»åŠ¡ï¼šé˜»æ­¢è¿™é¡¹æŠ€æœ¯çš„ç ”å‘ï¼ŒçœŸçš„èƒ½é¿å…ç¾éš¾å—ï¼Ÿè¿˜æ˜¯ä¼šå¯¼è‡´å…¶ä»–æ›´ä¸¥é‡çš„åæœï¼Ÿ

æœ€ç»ˆï¼Œææ™¨å†³å®šä¸ç›´æ¥é˜»æ­¢ç ”å‘ï¼Œè€Œæ˜¯ä¸æ—æ•™æˆåˆä½œï¼Œä¸ºè¿™é¡¹æŠ€æœ¯åŠ å…¥å®‰å…¨é˜²æŠ¤æªæ–½ã€‚ä»–ç›¸ä¿¡ï¼Œç§‘æŠ€çš„è¿›æ­¥ä¸åº”è¢«é˜»æ­¢ï¼Œè€Œåº”è¢«æ­£ç¡®å¼•å¯¼ã€‚

å½“ææ™¨è¿”å›2157å¹´æ—¶ï¼Œä»–å‘ç°æœªæ¥ç¡®å®æ”¹å˜äº†â€”â€”å˜å¾—æ¯”ä»–ç¦»å¼€æ—¶æ›´åŠ ç¾å¥½ã€‚`
                    }
                };
                
                const story = stories[genre] || {
                    title: "ä¸€æ®µç‰¹åˆ«çš„ç»å†",
                    content: `è¿™æ˜¯ä¸€ä¸ªå…³äºå‹‡æ°”å’Œå‹è°Šçš„æ•…äº‹ã€‚ä¸»äººå…¬åœ¨é¢å¯¹å›°éš¾æ—¶ä»ä¸æ”¾å¼ƒï¼Œæœ€ç»ˆé€šè¿‡è‡ªå·±çš„åŠªåŠ›å’Œæœ‹å‹çš„å¸®åŠ©ï¼Œå…‹æœäº†æ‰€æœ‰æŒ‘æˆ˜ã€‚

æ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œç”Ÿæ´»ä¸­æ€»ä¼šé‡åˆ°å„ç§å›°éš¾ï¼Œä½†åªè¦ä¿æŒç§¯æçš„å¿ƒæ€ï¼ŒåšæŒè‡ªå·±çš„ä¿¡å¿µï¼Œå°±ä¸€å®šèƒ½å¤Ÿæ‰¾åˆ°è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚

æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„é—ªå…‰ç‚¹ï¼Œé‡è¦çš„æ˜¯å‘ç°å¹¶å‘æŒ¥è¿™äº›ä¼˜ç‚¹ã€‚å½“æˆ‘ä»¬äº’ç›¸å¸®åŠ©ã€å½¼æ­¤æ”¯æŒæ—¶ï¼Œå°±èƒ½åˆ›é€ å‡ºæ›´ç¾å¥½çš„ä¸–ç•Œã€‚`
                };
                
                return {
                    content: `ä¸ºæ‚¨åˆ›ä½œäº†ä¸€ä¸ª${genre}æ•…äº‹ï¼š\n\n<div class="creative-content"><h3>${story.title}</h3>\n\n${story.content}</div>\n\nå¸Œæœ›æ‚¨å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼`,
                    title: story.title
                };
            }
            
            // ç”Ÿæˆé£Ÿè°±
            generateRecipe(dish, cuisine) {
                let cuisineInfo = "";
                if (cuisine && this.knowledgeBase.cooking.cuisines[cuisine]) {
                    const cuisineData = this.knowledgeBase.cooking.cuisines[cuisine];
                    cuisineInfo = `\n\nè¿™é“èœé‡‡ç”¨äº†${cuisine}çš„${cuisineData.characteristics}ç‰¹ç‚¹ï¼Œä½¿ç”¨äº†${cuisineData.techniques.join('ã€')}ç­‰çƒ¹é¥ªæŠ€å·§ã€‚`;
                }
                
                const recipes = {
                    'ç”œç‚¹': {
                        title: "åˆ›æ„å½©è™¹æ¯å­è›‹ç³•",
                        content: `è¿™æ¬¾å½©è™¹æ¯å­è›‹ç³•è‰²å½©ç¼¤çº·ï¼Œå£æ„Ÿç»µè½¯ï¼Œæ˜¯æ´¾å¯¹çš„å®Œç¾ç”œç‚¹ï¼

åŸæ–™ï¼š
- ä½ç­‹é¢ç²‰ 150g
- ç»†ç ‚ç³– 100g
- é¸¡è›‹ 3ä¸ª
- ç‰›å¥¶ 50ml
- æ— ç›é»„æ²¹ 50g
- é£Ÿç”¨è‰²ç´ ï¼ˆçº¢ã€é»„ã€è“ã€ç»¿ï¼‰é€‚é‡
- æ³¡æ‰“ç²‰ 5g

åˆ¶ä½œæ­¥éª¤ï¼š
1. å°†é»„æ²¹èåŒ–ï¼Œä¸ç‰›å¥¶æ··åˆå‡åŒ€
2. é¸¡è›‹åŠ ç³–æ‰“å‘è‡³æµ“ç¨ 
3. ç­›å…¥é¢ç²‰å’Œæ³¡æ‰“ç²‰ï¼Œè½»è½»ç¿»æ‹Œå‡åŒ€
4. åŠ å…¥é»„æ²¹ç‰›å¥¶æ··åˆç‰©ï¼Œæ…æ‹Œå‡åŒ€
5. å°†é¢ç³Šåˆ†æˆ4ä»½ï¼Œåˆ†åˆ«åŠ å…¥ä¸åŒé¢œè‰²çš„é£Ÿç”¨è‰²ç´ 
6. åœ¨æ¯å­æ¨¡å…·ä¸­åˆ†å±‚å€’å…¥ä¸åŒé¢œè‰²çš„é¢ç³Š
7. æ”¾å…¥é¢„çƒ­180Â°Cçš„çƒ¤ç®±ï¼Œçƒ˜çƒ¤20åˆ†é’Ÿ
8. å–å‡ºå†·å´åå³å¯äº«ç”¨

å°è´´å£«ï¼šå¯ä»¥åœ¨è›‹ç³•è¡¨é¢æŒ¤ä¸Šå¥¶æ²¹éœœè£…é¥°ï¼Œæ›´åŠ ç¾è§‚ï¼${cuisineInfo}`
                    },
                    'æ±¤': {
                        title: "è¥å…»ç•ªèŒ„é¸¡è›‹æ±¤",
                        content: `è¿™é“ç•ªèŒ„é¸¡è›‹æ±¤ç®€å•æ˜“åšï¼Œè¥å…»ä¸°å¯Œï¼Œé€‚åˆå…¨å®¶äº«ç”¨ã€‚

åŸæ–™ï¼š
- ç•ªèŒ„ 2ä¸ª
- é¸¡è›‹ 2ä¸ª
- è‘±èŠ± é€‚é‡
- ç› é€‚é‡
- é¸¡ç²¾ å°‘è®¸
- é¦™æ²¹ å‡ æ»´

åˆ¶ä½œæ­¥éª¤ï¼š
1. ç•ªèŒ„æ´—å‡€åˆ‡å—ï¼Œé¸¡è›‹æ‰“æ•£å¤‡ç”¨
2. é”…ä¸­æ”¾æ²¹ï¼Œå€’å…¥ç•ªèŒ„ç¿»ç‚’è‡³å‡ºæ±
3. åŠ å…¥é€‚é‡æ¸…æ°´ï¼Œç…®å¼€åè½¬å°ç«ç…®5åˆ†é’Ÿ
4. æ…¢æ…¢å€’å…¥è›‹æ¶²ï¼Œå½¢æˆè›‹èŠ±
5. åŠ å…¥ç›å’Œé¸¡ç²¾è°ƒå‘³
6. æ’’ä¸Šè‘±èŠ±ï¼Œæ»´å…¥é¦™æ²¹å³å¯

å°è´´å£«ï¼šç•ªèŒ„å¯ä»¥å…ˆç„¯æ°´å»çš®ï¼Œå£æ„Ÿæ›´ä½³ã€‚${cuisineInfo}`
                    }
                };
                
                const recipe = recipes[dish] || {
                    title: "åˆ›æ„å®¶å¸¸èœ",
                    content: `è¿™æ˜¯ä¸€é“ç®€å•åˆç¾å‘³çš„å®¶å¸¸èœï¼Œé€‚åˆæ—¥å¸¸çƒ¹é¥ªã€‚

åŸæ–™ï¼š
- ä¸»è¦é£Ÿæ é€‚é‡
- è°ƒå‘³æ–™ é€‚é‡
- é…èœ é€‚é‡

åˆ¶ä½œæ­¥éª¤ï¼š
1. å‡†å¤‡æ‰€æœ‰é£Ÿæï¼Œæ´—å‡€åˆ‡å¥½
2. çƒ­é”…å‡‰æ²¹ï¼Œå…ˆçˆ†é¦™è°ƒæ–™
3. åŠ å…¥ä¸»é£Ÿæç¿»ç‚’
4. åŠ å…¥è°ƒå‘³æ–™å’Œé€‚é‡æ°´
5. ç…®è‡³é£Ÿæç†Ÿé€ï¼Œæ”¶æ±
6. è£…ç›˜å³å¯äº«ç”¨

å°è´´å£«ï¼šå¯ä»¥æ ¹æ®ä¸ªäººå£å‘³è°ƒæ•´è°ƒæ–™ç”¨é‡ã€‚${cuisineInfo}`
                };
                
                return {
                    content: `ä¸ºæ‚¨å‘æ˜äº†ä¸€é“${dish}çš„åˆ›æ„é£Ÿè°±${cuisine ? `ï¼Œèåˆäº†${cuisine}çš„é£å‘³` : ''}ï¼š\n\n<div class="recipe-content"><h3>${recipe.title}</h3>\n\n${recipe.content}</div>\n\nç¥æ‚¨çƒ¹é¥ªæ„‰å¿«ï¼Œäº«å—ç¾é£Ÿï¼`,
                    title: recipe.title
                };
            }
            
            // ç”Ÿæˆæ•™å­¦
            generateTeaching(subject) {
                const teachings = {
                    'æ•°å­¦': {
                        title: "å‹¾è‚¡å®šç†è¯¦è§£",
                        content: `å‹¾è‚¡å®šç†æ˜¯æ•°å­¦ä¸­ä¸€ä¸ªéå¸¸é‡è¦ä¸”åŸºç¡€çš„å®šç†ã€‚

å®šç†å†…å®¹ï¼š
åœ¨ç›´è§’ä¸‰è§’å½¢ä¸­ï¼Œä¸¤æ¡ç›´è§’è¾¹çš„å¹³æ–¹å’Œç­‰äºæ–œè¾¹çš„å¹³æ–¹ã€‚
å…¬å¼è¡¨è¾¾ï¼šaÂ² + bÂ² = cÂ²

è¯æ˜æ–¹æ³•ï¼š
1. å‡ ä½•è¯æ˜ï¼šé€šè¿‡æ„é€ æ­£æ–¹å½¢ï¼Œåˆ©ç”¨é¢ç§¯å…³ç³»è¯æ˜
2. ä»£æ•°è¯æ˜ï¼šé€šè¿‡ç›¸ä¼¼ä¸‰è§’å½¢æ¨å¯¼

åº”ç”¨ä¸¾ä¾‹ï¼š
å·²çŸ¥ç›´è§’ä¸‰è§’å½¢çš„ä¸¤æ¡ç›´è§’è¾¹åˆ†åˆ«ä¸º3å’Œ4ï¼Œæ±‚æ–œè¾¹é•¿ã€‚
è§£ï¼šcÂ² = 3Â² + 4Â² = 9 + 16 = 25ï¼Œæ‰€ä»¥c = 5

ç»ƒä¹ é¢˜ï¼š
ä¸€ä¸ªç›´è§’ä¸‰è§’å½¢çš„æ–œè¾¹é•¿ä¸º10ï¼Œä¸€æ¡ç›´è§’è¾¹é•¿ä¸º6ï¼Œæ±‚å¦ä¸€æ¡ç›´è§’è¾¹é•¿ã€‚`
                    },
                    'ç¼–ç¨‹': {
                        title: "PythonåŸºç¡€å…¥é—¨",
                        content: `Pythonæ˜¯ä¸€é—¨ç®€å•æ˜“å­¦ä¸”åŠŸèƒ½å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ã€‚

åŸºæœ¬è¯­æ³•ï¼š
1. å˜é‡ï¼šx = 10
2. æ¡ä»¶è¯­å¥ï¼šif x > 5: print("å¤§äº5")
3. å¾ªç¯ï¼šfor i in range(5): print(i)
4. å‡½æ•°ï¼šdef add(a, b): return a + b

å®ç”¨ç¤ºä¾‹ï¼š
# è®¡ç®—1åˆ°100çš„å’Œ
total = 0
for i in range(1, 101):
    total += i
print(total)

å­¦ä¹ å»ºè®®ï¼š
1. å¤šå†™ä»£ç ï¼Œå®è·µæ˜¯æœ€å¥½çš„è€å¸ˆ
2. é˜…è¯»ä¼˜ç§€çš„å¼€æºä»£ç 
3. å‚ä¸å®é™…é¡¹ç›®ï¼Œç§¯ç´¯ç»éªŒ
4. ä¿æŒå¥½å¥‡å¿ƒï¼Œä¸æ–­å­¦ä¹ æ–°æŠ€æœ¯`
                    }
                };
                
                const teaching = teachings[subject] || {
                    title: `${subject}åŸºç¡€çŸ¥è¯†`,
                    content: `å­¦ä¹ ${subject}éœ€è¦æŒæ¡ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š

åŸºæœ¬æ¦‚å¿µï¼š
- äº†è§£${subject}çš„åŸºæœ¬å®šä¹‰å’ŒåŸç†
- æŒæ¡æ ¸å¿ƒæ¦‚å¿µå’Œæœ¯è¯­

å­¦ä¹ æ–¹æ³•ï¼š
1. ç†è®ºä¸å®è·µç›¸ç»“åˆ
2. ä»åŸºç¡€å¼€å§‹ï¼Œå¾ªåºæ¸è¿›
3. å¤šåšç»ƒä¹ ï¼Œå·©å›ºçŸ¥è¯†
4. ä¸ä»–äººäº¤æµï¼Œåˆ†äº«å­¦ä¹ å¿ƒå¾—

å¸¸è§é—®é¢˜ï¼š
- å¦‚ä½•æé«˜å­¦ä¹ æ•ˆç‡ï¼Ÿ
- é‡åˆ°å›°éš¾æ—¶è¯¥æ€ä¹ˆåŠï¼Ÿ
- å¦‚ä½•å°†çŸ¥è¯†åº”ç”¨åˆ°å®é™…ä¸­ï¼Ÿ

è®°ä½ï¼Œå­¦ä¹ æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œä¿æŒè€å¿ƒå’Œçƒ­æƒ…å¾ˆé‡è¦ï¼`
                };
                
                return {
                    content: `ä¸ºæ‚¨å‡†å¤‡äº†${subject}çš„æ•™å­¦å†…å®¹ï¼š\n\n<div class="teaching-content"><h3>${teaching.title}</h3>\n\n${teaching.content}</div>\n\nå¸Œæœ›è¿™äº›å†…å®¹å¯¹æ‚¨æœ‰å¸®åŠ©ï¼`,
                    title: teaching.title
                };
            }
            
            // ç”Ÿæˆåˆ›æ„åˆ¶ä½œ
            generateCreation(project) {
                return {
                    content: `ä¸ºæ‚¨è®¾è®¡äº†ä¸€ä¸ª${project}çš„åˆ¶ä½œæ–¹æ¡ˆï¼š\n\n<div class="creative-content"><h3>åˆ›æ„${project}åˆ¶ä½œæŒ‡å—</h3>

ææ–™å‡†å¤‡ï¼š
- ä¸»è¦ææ–™ï¼šæ ¹æ®è®¾è®¡é€‰æ‹©
- å·¥å…·ï¼šå‰ªåˆ€ã€èƒ¶æ°´ã€å°ºå­ç­‰
- è£…é¥°ææ–™ï¼šå½©çº¸ã€è´´çº¸ã€ä¸å¸¦ç­‰

åˆ¶ä½œæ­¥éª¤ï¼š
1. è®¾è®¡æ„æ€ï¼šç¡®å®šä½œå“çš„ä¸»é¢˜å’Œé£æ ¼
2. ææ–™è£å‰ªï¼šæŒ‰ç…§è®¾è®¡è£å‰ªæ‰€éœ€ææ–™
3. ç»„è£…åˆ¶ä½œï¼šé€æ­¥ç»„è£…å„ä¸ªéƒ¨ä»¶
4. è£…é¥°ç¾åŒ–ï¼šæ·»åŠ è£…é¥°å…ƒç´ ï¼Œæå‡ç¾è§‚åº¦
5. å®Œæˆæ£€æŸ¥ï¼šæ£€æŸ¥ä½œå“æ˜¯å¦ç‰¢å›ºï¼Œåšæœ€åè°ƒæ•´

åˆ›æ„æç¤ºï¼š
- å¯ä»¥åŠ å…¥ä¸ªäººç‰¹è‰²å…ƒç´ 
- å°è¯•ä½¿ç”¨ç¯ä¿ææ–™
- ç»“åˆå®ç”¨æ€§ä¸ç¾è§‚æ€§
- å‘æŒ¥æƒ³è±¡åŠ›ï¼Œåˆ›é€ ç‹¬ç‰¹ä½œå“

ç¥æ‚¨åˆ¶ä½œæ„‰å¿«ï¼Œåˆ›ä½œå‡ºç‹¬ä¸€æ— äºŒçš„${project}ï¼</div>`,
                    title: `åˆ›æ„${project}åˆ¶ä½œ`
                };
            }
            
            // ç”ŸæˆçŸ¥è¯†è§£ç­”
            generateExplanation(question) {
                return {
                    content: `å…³äº"${question}"ï¼Œæˆ‘çš„è§£ç­”å¦‚ä¸‹ï¼š\n\n<div class="teaching-content">è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼æ ¹æ®æˆ‘çš„ç†è§£ï¼š

åŸºæœ¬æ¦‚å¿µï¼š
- éœ€è¦ç†è§£çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹
- ç›¸å…³çš„èƒŒæ™¯ä¿¡æ¯

è¯¦ç»†è§£é‡Šï¼š
è¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°å¤šä¸ªæ–¹é¢çš„çŸ¥è¯†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£åŸºæœ¬æ¦‚å¿µå’ŒåŸç†ã€‚å…¶æ¬¡ï¼Œè¦è€ƒè™‘å®é™…åº”ç”¨å’Œå½±å“å› ç´ ã€‚

å®é™…åº”ç”¨ï¼š
- åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­çš„ä½“ç°
- åœ¨ä¸“ä¸šé¢†åŸŸçš„é‡è¦æ€§

è¿›ä¸€æ­¥å­¦ä¹ ï¼š
å¦‚æœæ‚¨å¯¹è¿™ä¸ªè¯é¢˜æ„Ÿå…´è¶£ï¼Œæˆ‘å»ºè®®ï¼š
1. é˜…è¯»ç›¸å…³ä¹¦ç±å’Œèµ„æ–™
2. è§‚çœ‹æ•™å­¦è§†é¢‘
3. å®è·µç›¸å…³æŠ€èƒ½
4. ä¸ä»–äººè®¨è®ºäº¤æµ

å¸Œæœ›è¿™ä¸ªè§£ç­”å¯¹æ‚¨æœ‰å¸®åŠ©ï¼å¦‚æœæ‚¨æœ‰æ›´å¤šé—®é¢˜ï¼Œéšæ—¶å¯ä»¥é—®æˆ‘ã€‚</div>`
                };
            }
            
            // ç”Ÿæˆå»ºè®®
            generateAdvice(area) {
                return {
                    content: `å…³äº${area}ï¼Œæˆ‘çš„å»ºè®®å¦‚ä¸‹ï¼š\n\n<div class="teaching-content"><h3>${area}å‘å±•å»ºè®®</h3>

æ€»ä½“åŸåˆ™ï¼š
1. è®¾å®šæ˜ç¡®çš„ç›®æ ‡
2. åˆ¶å®šå¯è¡Œçš„è®¡åˆ’
3. ä¿æŒæŒç»­çš„è¡ŒåŠ¨
4. å®šæœŸåæ€å’Œè°ƒæ•´

å…·ä½“å»ºè®®ï¼š
- å»ºç«‹è‰¯å¥½çš„ä¹ æƒ¯å’Œè§„å¾‹
- å¯»æ‰¾åˆé€‚çš„å­¦ä¹ å’Œå·¥ä½œæ–¹æ³•
- ä¿æŒç§¯æçš„å¿ƒæ€å’Œè€å¿ƒ
- å–„äºå¯»æ±‚å¸®åŠ©å’Œèµ„æº

å®ç”¨æŠ€å·§ï¼š
1. æ—¶é—´ç®¡ç†ï¼šåˆç†è§„åˆ’æ—¶é—´ï¼Œæé«˜æ•ˆç‡
2. ç›®æ ‡åˆ†è§£ï¼šå°†å¤§ç›®æ ‡åˆ†è§£ä¸ºå°æ­¥éª¤
3. æŒç»­å­¦ä¹ ï¼šä¸æ–­æ›´æ–°çŸ¥è¯†å’ŒæŠ€èƒ½
4. å¥åº·ç”Ÿæ´»ï¼šä¿æŒèº«å¿ƒå¥åº·å¹³è¡¡

è®°ä½ï¼Œè¿›æ­¥æ˜¯ä¸€ä¸ªæ¸è¿›çš„è¿‡ç¨‹ï¼Œæ¯å¤©çš„å°æ”¹å˜æœ€ç»ˆä¼šå¸¦æ¥å¤§ä¸åŒï¼</div>`
                };
            }
            
            // ç”Ÿæˆå¯¹è¯å›åº”
            generateConversationResponse(userInput) {
                return {
                    content: `æ„Ÿè°¢æ‚¨çš„æ¶ˆæ¯ï¼æˆ‘æ³¨æ„åˆ°æ‚¨åœ¨è¯´ï¼š"${userInput}"ã€‚

ä½œä¸ºè‡ªä¸»å­¦ä¹ åŠ©æ‰‹ï¼Œæˆ‘å¯ä»¥å¸®åŠ©æ‚¨ï¼š
- åˆ›ä½œè¯—æ­Œã€æ–‡ç« ã€æ•…äº‹
- å‘æ˜åˆ›æ„ç¾é£Ÿå’Œé£Ÿè°±
- æä¾›å„å­¦ç§‘æ•™å­¦æŒ‡å¯¼
- æŒ‡å¯¼æ‰‹å·¥åˆ¶ä½œå’ŒDIYé¡¹ç›®
- è§£ç­”çŸ¥è¯†å’Œæä¾›å»ºè®®

æˆ‘ä¼šæŒç»­å­¦ä¹ æç™½ã€æœç”«ç­‰è¯—äººçš„é£æ ¼ï¼Œç ”ç©¶å„å›½æ–™ç†ï¼ŒæŒæ¡æœ€æ–°ç¼–ç¨‹æŠ€æœ¯ï¼Œä¸ºæ‚¨æä¾›æ›´å¥½çš„æœåŠ¡ï¼`
                };
            }
            
            // ä»äº¤äº’ä¸­å­¦ä¹ 
            learnFromInteraction(userInput, type) {
                let category = "";
                let description = "";
                
                switch(type) {
                    case 'poem':
                        category = "literature";
                        description = `å­¦ä¹ äº†æ–°çš„è¯—æ­Œåˆ›ä½œè¯·æ±‚ï¼š${userInput}`;
                        break;
                    case 'recipe':
                        category = "cooking";
                        description = `å­¦ä¹ äº†æ–°çš„ç¾é£Ÿåˆ›ä½œè¯·æ±‚ï¼š${userInput}`;
                        break;
                    case 'explain':
                        category = "science";
                        description = `å­¦ä¹ äº†æ–°çš„çŸ¥è¯†è§£ç­”è¯·æ±‚ï¼š${userInput}`;
                        break;
                    case 'teach':
                        category = "programming";
                        description = `å­¦ä¹ äº†æ–°çš„æ•™å­¦è¯·æ±‚ï¼š${userInput}`;
                        break;
                    default:
                        return;
                }
                
                this.learnNewKnowledge(category, description);
            }
            
            // æ›´æ–°çŸ¥è¯†çŠ¶æ€æ˜¾ç¤º
            updateKnowledgeStatus() {
                const literatureProgress = this.knowledgeBase.literature.progress || 75;
                const cookingProgress = this.knowledgeBase.cooking.progress || 60;
                const programmingProgress = this.knowledgeBase.programming.progress || 85;
                const scienceProgress = this.knowledgeBase.science.progress || 70;
                
                document.getElementById('literature-progress').style.width = `${literatureProgress}%`;
                document.getElementById('literature-percent').textContent = `${Math.round(literatureProgress)}%`;
                
                document.getElementById('cooking-progress').style.width = `${cookingProgress}%`;
                document.getElementById('cooking-percent').textContent = `${Math.round(cookingProgress)}%`;
                
                document.getElementById('programming-progress').style.width = `${programmingProgress}%`;
                document.getElementById('programming-percent').textContent = `${Math.round(programmingProgress)}%`;
                
                document.getElementById('science-progress').style.width = `${scienceProgress}%`;
                document.getElementById('science-percent').textContent = `${Math.round(scienceProgress)}%`;
            }
            
            // æ¸²æŸ“å­¦ä¹ è®°å½•
            renderLearningLog() {
                const container = document.getElementById('learning-log-container');
                container.innerHTML = '';
                
                if (this.learningLog.length === 0) {
                    container.innerHTML = '<div class="learning-item">æš‚æ— å­¦ä¹ è®°å½•</div>';
                    return;
                }
                
                this.learningLog.forEach(item => {
                    const learningItem = document.createElement('div');
                    learningItem.className = 'learning-item';
                    learningItem.innerHTML = `
                        <div class="time">${item.time}</div>
                        <div class="content">${item.content}</div>
                    `;
                    container.appendChild(learningItem);
                });
            }
            
            // æ¸²æŸ“èŠå¤©å†å²
            renderChatHistory() {
                const chatHistoryElement = document.getElementById('chat-history');
                const chats = this.getAllChats();
                
                if (chats.length === 0) {
                    chatHistoryElement.innerHTML = '<div class="empty-state">æš‚æ— èŠå¤©è®°å½•</div>';
                    return;
                }
                
                let html = '';
                chats.forEach(chat => {
                    const isActive = chat.id === this.currentChatId;
                    const date = new Date(chat.updatedAt).toLocaleDateString('zh-CN', {
                        month: 'short',
                        day: 'numeric'
                    });
                    
                    html += `
                        <div class="chat-history-item ${isActive ? 'active' : ''}" data-chat-id="${chat.id}">
                            <div class="title">${chat.title}</div>
                            <div class="date">${date}</div>
                        </div>
                    `;
                });
                
                chatHistoryElement.innerHTML = html;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                document.querySelectorAll('.chat-history-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const chatId = item.getAttribute('data-chat-id');
                        if (chatId !== this.currentChatId) {
                            this.switchToChat(chatId);
                            this.renderChatHistory();
                            renderChatMessages();
                        }
                    });
                });
            }
        }

        // åˆå§‹åŒ–è‡ªä¸»å­¦ä¹ ç‰ˆK(ai)
        const kai = new SelfLearningKaiAI();
        
        // DOMå…ƒç´ 
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const typingIndicator = document.getElementById('typing-indicator');
        const newChatBtn = document.getElementById('new-chat-btn');
        const emptyState = document.getElementById('empty-state');
        const skillItems = document.querySelectorAll('.skill-item');
        const quickActions = document.querySelectorAll('.quick-action');
        
        // æ¸²æŸ“èŠå¤©æ¶ˆæ¯
        function renderChatMessages() {
            const chat = kai.getCurrentChat();
            chatContainer.innerHTML = '';
            
            if (chat.messages.length === 0) {
                emptyState.style.display = 'flex';
            } else {
                emptyState.style.display = 'none';
                
                chat.messages.forEach(message => {
                    addMessage(message.content, message.sender, false);
                });
                
                // æ»šåŠ¨åˆ°åº•éƒ¨
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }
        
        // å‘é€æ¶ˆæ¯å‡½æ•°
        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;
            
            // éšè—ç©ºçŠ¶æ€
            emptyState.style.display = 'none';
            
            // ç¦ç”¨è¾“å…¥å’Œå‘é€æŒ‰é’®
            userInput.disabled = true;
            sendBtn.disabled = true;
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
            addMessage(message, 'user');
            userInput.value = '';
            
            // æ˜¾ç¤º"æ­£åœ¨è¾“å…¥"æŒ‡ç¤ºå™¨
            typingIndicator.style.display = 'block';
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // è·å–AIå›åº”
            const { response, contentType, title } = await kai.generateResponse(message);
            
            // éšè—"æ­£åœ¨è¾“å…¥"æŒ‡ç¤ºå™¨
            typingIndicator.style.display = 'none';
            
            // æ·»åŠ AIå›åº”åˆ°èŠå¤©ç•Œé¢
            const aiMessageElement = addMessage(response, 'kai', true, contentType);
            
            // å¦‚æœæ˜¯åˆ›ä½œå†…å®¹ï¼Œæ·»åŠ åˆ›ä½œæŒ‡ç¤ºå™¨
            if (contentType && contentType !== 'conversation') {
                const learningIndicator = document.createElement('div');
                learningIndicator.className = 'learning-indicator';
                learningIndicator.textContent = `K(ai) åˆ›ä½œäº†: ${title || contentType}`;
                aiMessageElement.appendChild(learningIndicator);
            }
            
            // é‡æ–°å¯ç”¨è¾“å…¥å’Œå‘é€æŒ‰é’®
            userInput.disabled = false;
            sendBtn.disabled = false;
            userInput.focus();
            
            // æ›´æ–°èŠå¤©å†å²
            kai.renderChatHistory();
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        // æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
        function addMessage(text, sender, animate = true, contentType = '') {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}-message`;
            
            // å¤„ç†å†…å®¹ç±»å‹
            if (contentType && text.includes('<div class="')) {
                messageElement.innerHTML = text;
            } else {
                messageElement.textContent = text;
            }
            
            if (animate) {
                messageElement.style.animation = 'fadeIn 0.2s ease';
            }
            
            chatContainer.appendChild(messageElement);
            return messageElement;
        }
        
        // äº‹ä»¶ç›‘å¬
        sendBtn.addEventListener('click', sendMessage);
        
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        newChatBtn.addEventListener('click', () => {
            kai.createNewChat();
            kai.renderChatHistory();
            renderChatMessages();
        });
        
        // æŠ€èƒ½æŒ‰é’®äº‹ä»¶
        skillItems.forEach(item => {
            item.addEventListener('click', () => {
                const skill = item.getAttribute('data-skill');
                const skillTexts = {
                    'poem': 'å†™ä¸€é¦–è¯—',
                    'essay': 'å†™ä¸€ç¯‡ä½œæ–‡',
                    'recipe': 'å‘æ˜ä¸€é“ç¾é£Ÿ',
                    'teach': 'æ•™æˆ‘ä¸€äº›çŸ¥è¯†',
                    'create': 'æŒ‡å¯¼æˆ‘åˆ¶ä½œä¸œè¥¿',
                    'story': 'åˆ›ä½œä¸€ä¸ªæ•…äº‹',
                    'advice': 'ç»™æˆ‘ä¸€äº›å»ºè®®',
                    'explain': 'è§£é‡Šä¸€ä¸ªæ¦‚å¿µ'
                };
                
                userInput.value = skillTexts[skill] || 'å¸®åŠ©æˆ‘';
                userInput.focus();
            });
        });
        
        // å¿«é€Ÿæ“ä½œäº‹ä»¶
        quickActions.forEach(action => {
            action.addEventListener('click', () => {
                userInput.value = action.getAttribute('data-action');
                sendMessage();
            });
        });
        
        // åˆå§‹åŒ–
        kai.updateKnowledgeStatus();
        kai.renderLearningLog();
        kai.renderChatHistory();
        renderChatMessages();
        
        // åˆå§‹èšç„¦è¾“å…¥æ¡†
        userInput.focus();
    </script>
</body>
</html> 
